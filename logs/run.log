
API Logic Project Server Setup (01JMW56P6X34M85CN1WNAZCFFR) Starting with CLI args: 
.. api_logic_server_run.py

Created August 03, 2024 09:34:01 at /opt/projects/by-ulid/01JMW56P6X34M85CN1WNAZCFFR

Data Model Loaded, customizing...
..discovered models: []
LogicBank Activation - declare_logic.py
Loading rules from /opt/projects/by-ulid/01JMW56P6X34M85CN1WNAZCFFR/logic/wg_rules
01JMW5DWSE1BEGMTDQR2RQ61TW rule file: logic/wg_rules/Person_Total_Hours.py
01JMW5DWVCNE5Y6R0EPFYJB094 rule file: logic/wg_rules/Person_Total_Amount.py
01JMW5DWW29JKP1CR7WTPRYBDT rule file: logic/wg_rules/Person_Billing_Rate_Constraint.py
01JMW5DWWXY42Q5TKGTMYJH454 rule file: logic/wg_rules/Timesheet_Copy_Rate.py
01JMW5DWX9Q6GB7F5GKC75W9QG rule file: logic/wg_rules/Timesheet_Amount_Billed.py
01JMW5DWY1NGPH7CE3WQXDNVQ0 rule file: logic/wg_rules/Timesheet_Hours_Worked_Constraint.py
01JMW5DWYTXJ3N98QVWCYV7FBM rule file: logic/wg_rules/Task_Hours_Calculations.py
01JMW5DWZ5V2FAMVYFVC0DD7GP rule file: logic/wg_rules/Task_Amount_Calculations.py
01JMW5DWZF891E8702490NSGHA rule file: logic/wg_rules/Task_Budget_Check.py
01JMW5DX03KFYJA5AJK9C8KYS9 rule file: logic/wg_rules/Project_Hours_Calculations.py
01JMW5DX0TD8SHCZYE7G1MSQ7J rule file: logic/wg_rules/Project_Amount_Calculations.py
01JMW5DX1B07T9QV15HE1V5MFB rule file: logic/wg_rules/Project_Budget_Check.py
01JMW5DX1R3BXWYJH4CH4650DK rule file: logic/wg_rules/Client_Hours_Calculations.py
01JMW5DX27DQABTT3XZ6TP985N rule file: logic/wg_rules/Client_Amount_Calculations.py
01JMW5DX34P4CF7NAPZEWJ67P7 rule file: logic/wg_rules/Client_Budget_Check.py
01JMW5DX3JV7G9ZE5P9H9HXM6H rule file: logic/wg_rules/Client_Invoice_Total_Calculation.py
01JMW5DX43MBDE38C28W76HVAR rule file: logic/wg_rules/Client_Payment_Total_Calculation.py
01JMW5DX4EJ2M8C6XJDQDEH5RM rule file: logic/wg_rules/Client_Kafka_Event.py
01JMW5DX59HGF46T3DHPD0GD8K rule file: logic/wg_rules/Invoice_Amount_Credit.py
01JMW5DX5WFK04KWHEPE33GDRJ rule file: logic/wg_rules/Invoice_Payment_Credit.py
01JMW5DX69TVMQ1S9QRHJS74D9 rule file: logic/wg_rules/Invoice_Balance_Calculation.py
01JMW5DX76ZTX5M03HR47KTT06 rule file: logic/wg_rules/Invoice_Payment_Constraint.py
01JMW5DX7RZD5NJYGT45RKA48Q rule file: logic/wg_rules/Invoice_Task_Count_Calculation.py
01JMW5DX866R30GT9X5FEXBVYM rule file: logic/wg_rules/Invoice_Task_Completion_Count.py
01JMW5DX9694SWB6AF2ZWDG4QH rule file: logic/wg_rules/Invoice_Readiness_Check.py
01JMW5DX9TSQXHGRJD88PYV2D9 rule file: logic/wg_rules/Invoice_Kafka_Event.py
01JMW5DXA53HY0Z8R16HP0X1TC rule file: logic/wg_rules/InvoiceItem_Task_Amount.py
01JMW5DXAQJNWBP7364GXGB0CX rule file: logic/wg_rules/InvoiceItem_Completion_Check.py
[32mLoading Rule Module Person_Total_Hours 01JMW5DWSE1BEGMTDQR2RQ61TW [0m
[32mLoading Rule Module Person_Total_Amount 01JMW5DWVCNE5Y6R0EPFYJB094 [0m
[32mLoading Rule Module Person_Billing_Rate_Constraint 01JMW5DWW29JKP1CR7WTPRYBDT [0m
[32mLoading Rule Module Timesheet_Copy_Rate 01JMW5DWWXY42Q5TKGTMYJH454 [0m
[32mLoading Rule Module Timesheet_Amount_Billed 01JMW5DWX9Q6GB7F5GKC75W9QG [0m
[32mLoading Rule Module Timesheet_Hours_Worked_Constraint 01JMW5DWY1NGPH7CE3WQXDNVQ0 [0m
[32mLoading Rule Module Task_Hours_Calculations 01JMW5DWYTXJ3N98QVWCYV7FBM [0m
[32mLoading Rule Module Task_Amount_Calculations 01JMW5DWZ5V2FAMVYFVC0DD7GP [0m
[32mLoading Rule Module Task_Budget_Check 01JMW5DWZF891E8702490NSGHA [0m
[32mLoading Rule Module Project_Hours_Calculations 01JMW5DX03KFYJA5AJK9C8KYS9 [0m
[32mLoading Rule Module Project_Amount_Calculations 01JMW5DX0TD8SHCZYE7G1MSQ7J [0m
[32mLoading Rule Module Project_Budget_Check 01JMW5DX1B07T9QV15HE1V5MFB [0m
[32mLoading Rule Module Client_Hours_Calculations 01JMW5DX1R3BXWYJH4CH4650DK [0m
[32mLoading Rule Module Client_Amount_Calculations 01JMW5DX27DQABTT3XZ6TP985N [0m
[32mLoading Rule Module Client_Budget_Check 01JMW5DX34P4CF7NAPZEWJ67P7 [0m
[32mLoading Rule Module Client_Invoice_Total_Calculation 01JMW5DX3JV7G9ZE5P9H9HXM6H [0m
[32mLoading Rule Module Client_Payment_Total_Calculation 01JMW5DX43MBDE38C28W76HVAR [0m
[32mLoading Rule Module Client_Kafka_Event 01JMW5DX4EJ2M8C6XJDQDEH5RM [0m
[32mLoading Rule Module Invoice_Amount_Credit 01JMW5DX59HGF46T3DHPD0GD8K [0m
[32mLoading Rule Module Invoice_Payment_Credit 01JMW5DX5WFK04KWHEPE33GDRJ [0m
[32mLoading Rule Module Invoice_Balance_Calculation 01JMW5DX69TVMQ1S9QRHJS74D9 [0m
[32mLoading Rule Module Invoice_Payment_Constraint 01JMW5DX76ZTX5M03HR47KTT06 [0m
[32mLoading Rule Module Invoice_Task_Count_Calculation 01JMW5DX7RZD5NJYGT45RKA48Q [0m
[32mLoading Rule Module Invoice_Task_Completion_Count 01JMW5DX866R30GT9X5FEXBVYM [0m
[32mLoading Rule Module Invoice_Readiness_Check 01JMW5DX9694SWB6AF2ZWDG4QH [0m
[32mLoading Rule Module Invoice_Kafka_Event 01JMW5DX9TSQXHGRJD88PYV2D9 [0m
[32mLoading Rule Module InvoiceItem_Task_Amount 01JMW5DXA53HY0Z8R16HP0X1TC [0m
[32mLoading Rule Module InvoiceItem_Completion_Check 01JMW5DXAQJNWBP7364GXGB0CX [0m

The following rules have been loaded
Rule Bank[0x7bba7ca0c800] (loaded 2025-02-24 14:24:28.944708)
Mapped Class[Person] rules:
  Derive <class 'database.models.Person'>.total_hours_entered as Sum(Timesheet.hours_worked Where  - None)
  Derive <class 'database.models.Person'>.total_amount_billed as Formula (-1): Rule.formula(derive=Person.total_amount_billed, a [...]
  Constraint Function: None 
Mapped Class[Timesheet] rules:
  Derive <class 'database.models.Timesheet'>.billing_rate as Copy(person.billing_rate)
  Derive <class 'database.models.Timesheet'>.total_amount_billed as Formula (-1): Rule.formula(derive=Timesheet.total_amount_billed [...]
  Constraint Function: None 
Mapped Class[Task] rules:
  Derive <class 'database.models.Task'>.total_task_hours_worked as Sum(Timesheet.hours_worked Where  - None)
  Derive <class 'database.models.Task'>.total_task_amount_billed as Sum(Timesheet.total_amount_billed Where  - None)
  Derive <class 'database.models.Task'>.is_over_budget as Formula (-1): Rule.formula(derive=Task.is_over_budget, as_expre [...]
Mapped Class[Project] rules:
  Derive <class 'database.models.Project'>.total_project_hours as Sum(Task.total_task_hours_worked Where  - None)
  Derive <class 'database.models.Project'>.total_project_amount as Sum(Task.total_task_amount_billed Where  - None)
  Derive <class 'database.models.Project'>.is_over_budget as Formula (-1): Rule.formula(derive=Project.is_over_budget, as_ex [...]
Mapped Class[Client] rules:
  Derive <class 'database.models.Client'>.total_hours as Sum(Project.total_project_hours Where  - None)
  Derive <class 'database.models.Client'>.total_amount as Sum(Project.total_project_amount Where  - None)
  Derive <class 'database.models.Client'>.is_over_budget as Formula (-1): Rule.formula(derive=Client.is_over_budget, as_exp [...]
  Derive <class 'database.models.Client'>.invoice_total as Sum(Invoice.invoice_amount Where  - None)
  Derive <class 'database.models.Client'>.payment_total as Sum(Invoice.payment_total Where  - None)
  RowEvent Client.send_row_to_kafka() 
Mapped Class[Invoice] rules:
  Derive <class 'database.models.Invoice'>.invoice_amount as Sum(InvoiceItem.task_amount Where  - None)
  Derive <class 'database.models.Invoice'>.payment_total as Sum(Payment.amount Where  - None)
  Derive <class 'database.models.Invoice'>.invoice_balance as Formula (-1): Rule.formula(derive=Invoice.invoice_balance, as_e [...]
  Derive <class 'database.models.Invoice'>.is_paid as Formula (-1): Rule.formula(derive=Invoice.is_paid, as_expressio [...]
  Derive <class 'database.models.Invoice'>.task_count as Count(<class 'database.models.InvoiceItem'> Where  - None)
  Derive <class 'database.models.Invoice'>.completed_task_count as Count(<class 'database.models.InvoiceItem'> Where Rule.count(derive=Invoice.completed_task_count, as_count_of=InvoiceItem, where=lambda row: row.is_completed is True) - <function init_rule.<locals>.<lambda> at 0x7bba7c759c60>)
  Derive <class 'database.models.Invoice'>.is_ready as Formula (-1): Rule.formula(derive=Invoice.is_ready, as_expressi [...]
  RowEvent Invoice.send_row_to_kafka() 
Mapped Class[InvoiceItem] rules:
  Derive <class 'database.models.InvoiceItem'>.task_amount as Copy(task.total_task_amount_billed)
  Derive <class 'database.models.InvoiceItem'>.is_completed as Copy(task.is_completed)

The following attributes have been referenced

..Person.total_hours_entered: aggregate derivation
..Timesheet.hours_worked: sum derived from
..Person.total_hours_entered: - formula
..Person.billing_rate: - formula
..Person.billing_rate: constraint
..Timesheet.billing_rate: parent copy derivation
..Person.billing_rate: parent copy from
..Timesheet.billing_rate: - formula
..Timesheet.hours_worked: - formula
..Timesheet.is_billable: - formula
..Timesheet.hours_worked: constraint
..Task.total_task_hours_worked: aggregate derivation
..Timesheet.hours_worked: sum derived from
..Task.total_task_amount_billed: aggregate derivation
..Timesheet.total_amount_billed: sum derived from
..Task.total_task_hours_worked: - formula
..Task.task_budget_hours: - formula
..Project.total_project_hours: aggregate derivation
..Task.total_task_hours_worked: sum derived from
..Project.total_project_amount: aggregate derivation
..Task.total_task_amount_billed: sum derived from
..Project.total_project_amount: - formula
..Project.project_budget_amount: - formula
..Client.total_hours: aggregate derivation
..Project.total_project_hours: sum derived from
..Client.total_amount: aggregate derivation
..Project.total_project_amount: sum derived from
..Client.total_amount: - formula
..Client.budget_amount: - formula
..Client.invoice_total: aggregate derivation
..Invoice.invoice_amount: sum derived from
..Client.payment_total: aggregate derivation
..Invoice.payment_total: sum derived from
..Invoice.invoice_amount: aggregate derivation
..InvoiceItem.task_amount: sum derived from
..Invoice.payment_total: aggregate derivation
..Payment.amount: sum derived from
..Invoice.invoice_amount: - formula
..Invoice.payment_total: - formula
..Invoice.invoice_balance: - formula
..Invoice.task_count: aggregate derivation
..Invoice.completed_task_count: aggregate derivation
..InvoiceItem.is_completed: aggregate where clause
..Invoice.task_count: - formula
..Invoice.completed_task_count: - formula
..InvoiceItem.task_amount: parent copy derivation
..Task.total_task_amount_billed: parent copy from
..InvoiceItem.is_completed: parent copy derivation
..Task.is_completed: parent copy from

The following rules have been activated
Rule Bank[0x7bba7ca0c800] (loaded 2025-02-24 14:24:28.944708)
Mapped Class[Person] rules:
  Derive <class 'database.models.Person'>.total_hours_entered as Sum(Timesheet.hours_worked Where  - None)
  Derive <class 'database.models.Person'>.total_amount_billed as Formula (1): Rule.formula(derive=Person.total_amount_billed, a [...]
  Constraint Function: None 
Mapped Class[Timesheet] rules:
  Derive <class 'database.models.Timesheet'>.billing_rate as Copy(person.billing_rate)
  Derive <class 'database.models.Timesheet'>.total_amount_billed as Formula (1): Rule.formula(derive=Timesheet.total_amount_billed [...]
  Constraint Function: None 
Mapped Class[Task] rules:
  Derive <class 'database.models.Task'>.total_task_hours_worked as Sum(Timesheet.hours_worked Where  - None)
  Derive <class 'database.models.Task'>.total_task_amount_billed as Sum(Timesheet.total_amount_billed Where  - None)
  Derive <class 'database.models.Task'>.is_over_budget as Formula (1): Rule.formula(derive=Task.is_over_budget, as_expre [...]
Mapped Class[Project] rules:
  Derive <class 'database.models.Project'>.total_project_hours as Sum(Task.total_task_hours_worked Where  - None)
  Derive <class 'database.models.Project'>.total_project_amount as Sum(Task.total_task_amount_billed Where  - None)
  Derive <class 'database.models.Project'>.is_over_budget as Formula (1): Rule.formula(derive=Project.is_over_budget, as_ex [...]
Mapped Class[Client] rules:
  Derive <class 'database.models.Client'>.total_hours as Sum(Project.total_project_hours Where  - None)
  Derive <class 'database.models.Client'>.total_amount as Sum(Project.total_project_amount Where  - None)
  Derive <class 'database.models.Client'>.is_over_budget as Formula (1): Rule.formula(derive=Client.is_over_budget, as_exp [...]
  Derive <class 'database.models.Client'>.invoice_total as Sum(Invoice.invoice_amount Where  - None)
  Derive <class 'database.models.Client'>.payment_total as Sum(Invoice.payment_total Where  - None)
  RowEvent Client.send_row_to_kafka() 
Mapped Class[Invoice] rules:
  Derive <class 'database.models.Invoice'>.invoice_amount as Sum(InvoiceItem.task_amount Where  - None)
  Derive <class 'database.models.Invoice'>.payment_total as Sum(Payment.amount Where  - None)
  Derive <class 'database.models.Invoice'>.invoice_balance as Formula (1): Rule.formula(derive=Invoice.invoice_balance, as_e [...]
  Derive <class 'database.models.Invoice'>.is_paid as Formula (2): Rule.formula(derive=Invoice.is_paid, as_expressio [...]
  Derive <class 'database.models.Invoice'>.task_count as Count(<class 'database.models.InvoiceItem'> Where  - None)
  Derive <class 'database.models.Invoice'>.completed_task_count as Count(<class 'database.models.InvoiceItem'> Where Rule.count(derive=Invoice.completed_task_count, as_count_of=InvoiceItem, where=lambda row: row.is_completed is True) - <function init_rule.<locals>.<lambda> at 0x7bba7c759c60>)
  Derive <class 'database.models.Invoice'>.is_ready as Formula (3): Rule.formula(derive=Invoice.is_ready, as_expressi [...]
  RowEvent Invoice.send_row_to_kafka() 
Mapped Class[InvoiceItem] rules:
  Derive <class 'database.models.InvoiceItem'>.task_amount as Copy(task.total_task_amount_billed)
  Derive <class 'database.models.InvoiceItem'>.is_completed as Copy(task.is_completed)
Logic Bank 01.20.25 - 36 rules loaded
Exposing /Client
Exposing /Invoice
Exposing /InvoiceItem
Exposing /Payment
Exposing /Person
Exposing /Project
Exposing /Task
Exposing /Timesheet
Declare   API - api/expose_api_models, endpoint for each table on g.apifabric.ai:443, customizing...
..discovered services: ['new_service.py', 'newer_service.py', 'ontimize_api.py', 'system.py']

Authentication loaded -- api calls now require authorization header
..declare security - security/declare_security.py authentication tables loaded
Kafka Consumer not activated

API Logic Project loaded (not WSGI), version 14.03.09
.. startup message: normal start
 (running from docker container at flask_host: 0.0.0.0 - may require refresh)

API Logic Project (name: 01JMW56P6X34M85CN1WNAZCFFR) starting:
..Explore data and API at http_scheme://swagger_host:port https://g.apifabric.ai:6800   *
.... with flask_host: 0.0.0.0
.... and  swagger_port: 443

Alert: These following are **Critical** to unlocking value for project: 01JMW56P6X34M85CN1WNAZCFFR:
.. see logic.declare_logic.py       -- 
.. see security.declare_security.py -- No Grants Yet


*************************************************************************
*   Startup Instructions: Open your Browser at: https://g.apifabric.ai:6800   *
*************************************************************************

 * Serving Flask app 'API Logic Server'
 * Debug mode: on
[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:6800
 * Running on http://172.18.0.2:6800
[33mPress CTRL+C to quit[0m
 * Restarting with stat

API Logic Project Server Setup (01JMW56P6X34M85CN1WNAZCFFR) Starting with CLI args: 
.. api_logic_server_run.py

Created August 03, 2024 09:34:01 at /opt/projects/by-ulid/01JMW56P6X34M85CN1WNAZCFFR

Data Model Loaded, customizing...
..discovered models: []
LogicBank Activation - declare_logic.py
Loading rules from /opt/projects/by-ulid/01JMW56P6X34M85CN1WNAZCFFR/logic/wg_rules
01JMW5DWSE1BEGMTDQR2RQ61TW rule file: logic/wg_rules/Person_Total_Hours.py
01JMW5DWVCNE5Y6R0EPFYJB094 rule file: logic/wg_rules/Person_Total_Amount.py
01JMW5DWW29JKP1CR7WTPRYBDT rule file: logic/wg_rules/Person_Billing_Rate_Constraint.py
01JMW5DWWXY42Q5TKGTMYJH454 rule file: logic/wg_rules/Timesheet_Copy_Rate.py
01JMW5DWX9Q6GB7F5GKC75W9QG rule file: logic/wg_rules/Timesheet_Amount_Billed.py
01JMW5DWY1NGPH7CE3WQXDNVQ0 rule file: logic/wg_rules/Timesheet_Hours_Worked_Constraint.py
01JMW5DWYTXJ3N98QVWCYV7FBM rule file: logic/wg_rules/Task_Hours_Calculations.py
01JMW5DWZ5V2FAMVYFVC0DD7GP rule file: logic/wg_rules/Task_Amount_Calculations.py
01JMW5DWZF891E8702490NSGHA rule file: logic/wg_rules/Task_Budget_Check.py
01JMW5DX03KFYJA5AJK9C8KYS9 rule file: logic/wg_rules/Project_Hours_Calculations.py
01JMW5DX0TD8SHCZYE7G1MSQ7J rule file: logic/wg_rules/Project_Amount_Calculations.py
01JMW5DX1B07T9QV15HE1V5MFB rule file: logic/wg_rules/Project_Budget_Check.py
01JMW5DX1R3BXWYJH4CH4650DK rule file: logic/wg_rules/Client_Hours_Calculations.py
01JMW5DX27DQABTT3XZ6TP985N rule file: logic/wg_rules/Client_Amount_Calculations.py
01JMW5DX34P4CF7NAPZEWJ67P7 rule file: logic/wg_rules/Client_Budget_Check.py
01JMW5DX3JV7G9ZE5P9H9HXM6H rule file: logic/wg_rules/Client_Invoice_Total_Calculation.py
01JMW5DX43MBDE38C28W76HVAR rule file: logic/wg_rules/Client_Payment_Total_Calculation.py
01JMW5DX4EJ2M8C6XJDQDEH5RM rule file: logic/wg_rules/Client_Kafka_Event.py
01JMW5DX59HGF46T3DHPD0GD8K rule file: logic/wg_rules/Invoice_Amount_Credit.py
01JMW5DX5WFK04KWHEPE33GDRJ rule file: logic/wg_rules/Invoice_Payment_Credit.py
01JMW5DX69TVMQ1S9QRHJS74D9 rule file: logic/wg_rules/Invoice_Balance_Calculation.py
01JMW5DX76ZTX5M03HR47KTT06 rule file: logic/wg_rules/Invoice_Payment_Constraint.py
01JMW5DX7RZD5NJYGT45RKA48Q rule file: logic/wg_rules/Invoice_Task_Count_Calculation.py
01JMW5DX866R30GT9X5FEXBVYM rule file: logic/wg_rules/Invoice_Task_Completion_Count.py
01JMW5DX9694SWB6AF2ZWDG4QH rule file: logic/wg_rules/Invoice_Readiness_Check.py
01JMW5DX9TSQXHGRJD88PYV2D9 rule file: logic/wg_rules/Invoice_Kafka_Event.py
01JMW5DXA53HY0Z8R16HP0X1TC rule file: logic/wg_rules/InvoiceItem_Task_Amount.py
01JMW5DXAQJNWBP7364GXGB0CX rule file: logic/wg_rules/InvoiceItem_Completion_Check.py
[32mLoading Rule Module Person_Total_Hours 01JMW5DWSE1BEGMTDQR2RQ61TW [0m
[32mLoading Rule Module Person_Total_Amount 01JMW5DWVCNE5Y6R0EPFYJB094 [0m
[32mLoading Rule Module Person_Billing_Rate_Constraint 01JMW5DWW29JKP1CR7WTPRYBDT [0m
[32mLoading Rule Module Timesheet_Copy_Rate 01JMW5DWWXY42Q5TKGTMYJH454 [0m
[32mLoading Rule Module Timesheet_Amount_Billed 01JMW5DWX9Q6GB7F5GKC75W9QG [0m
[32mLoading Rule Module Timesheet_Hours_Worked_Constraint 01JMW5DWY1NGPH7CE3WQXDNVQ0 [0m
[32mLoading Rule Module Task_Hours_Calculations 01JMW5DWYTXJ3N98QVWCYV7FBM [0m
[32mLoading Rule Module Task_Amount_Calculations 01JMW5DWZ5V2FAMVYFVC0DD7GP [0m
[32mLoading Rule Module Task_Budget_Check 01JMW5DWZF891E8702490NSGHA [0m
[32mLoading Rule Module Project_Hours_Calculations 01JMW5DX03KFYJA5AJK9C8KYS9 [0m
[32mLoading Rule Module Project_Amount_Calculations 01JMW5DX0TD8SHCZYE7G1MSQ7J [0m
[32mLoading Rule Module Project_Budget_Check 01JMW5DX1B07T9QV15HE1V5MFB [0m
[32mLoading Rule Module Client_Hours_Calculations 01JMW5DX1R3BXWYJH4CH4650DK [0m
[32mLoading Rule Module Client_Amount_Calculations 01JMW5DX27DQABTT3XZ6TP985N [0m
[32mLoading Rule Module Client_Budget_Check 01JMW5DX34P4CF7NAPZEWJ67P7 [0m
[32mLoading Rule Module Client_Invoice_Total_Calculation 01JMW5DX3JV7G9ZE5P9H9HXM6H [0m
[32mLoading Rule Module Client_Payment_Total_Calculation 01JMW5DX43MBDE38C28W76HVAR [0m
[32mLoading Rule Module Client_Kafka_Event 01JMW5DX4EJ2M8C6XJDQDEH5RM [0m
[32mLoading Rule Module Invoice_Amount_Credit 01JMW5DX59HGF46T3DHPD0GD8K [0m
[32mLoading Rule Module Invoice_Payment_Credit 01JMW5DX5WFK04KWHEPE33GDRJ [0m
[32mLoading Rule Module Invoice_Balance_Calculation 01JMW5DX69TVMQ1S9QRHJS74D9 [0m
[32mLoading Rule Module Invoice_Payment_Constraint 01JMW5DX76ZTX5M03HR47KTT06 [0m
[32mLoading Rule Module Invoice_Task_Count_Calculation 01JMW5DX7RZD5NJYGT45RKA48Q [0m
[32mLoading Rule Module Invoice_Task_Completion_Count 01JMW5DX866R30GT9X5FEXBVYM [0m
[32mLoading Rule Module Invoice_Readiness_Check 01JMW5DX9694SWB6AF2ZWDG4QH [0m
[32mLoading Rule Module Invoice_Kafka_Event 01JMW5DX9TSQXHGRJD88PYV2D9 [0m
[32mLoading Rule Module InvoiceItem_Task_Amount 01JMW5DXA53HY0Z8R16HP0X1TC [0m
[32mLoading Rule Module InvoiceItem_Completion_Check 01JMW5DXAQJNWBP7364GXGB0CX [0m

The following rules have been loaded
Rule Bank[0x7c9e14b298e0] (loaded 2025-02-24 14:24:39.910724)
Mapped Class[Person] rules:
  Derive <class 'database.models.Person'>.total_hours_entered as Sum(Timesheet.hours_worked Where  - None)
  Derive <class 'database.models.Person'>.total_amount_billed as Formula (-1): Rule.formula(derive=Person.total_amount_billed, a [...]
  Constraint Function: None 
Mapped Class[Timesheet] rules:
  Derive <class 'database.models.Timesheet'>.billing_rate as Copy(person.billing_rate)
  Derive <class 'database.models.Timesheet'>.total_amount_billed as Formula (-1): Rule.formula(derive=Timesheet.total_amount_billed [...]
  Constraint Function: None 
Mapped Class[Task] rules:
  Derive <class 'database.models.Task'>.total_task_hours_worked as Sum(Timesheet.hours_worked Where  - None)
  Derive <class 'database.models.Task'>.total_task_amount_billed as Sum(Timesheet.total_amount_billed Where  - None)
  Derive <class 'database.models.Task'>.is_over_budget as Formula (-1): Rule.formula(derive=Task.is_over_budget, as_expre [...]
Mapped Class[Project] rules:
  Derive <class 'database.models.Project'>.total_project_hours as Sum(Task.total_task_hours_worked Where  - None)
  Derive <class 'database.models.Project'>.total_project_amount as Sum(Task.total_task_amount_billed Where  - None)
  Derive <class 'database.models.Project'>.is_over_budget as Formula (-1): Rule.formula(derive=Project.is_over_budget, as_ex [...]
Mapped Class[Client] rules:
  Derive <class 'database.models.Client'>.total_hours as Sum(Project.total_project_hours Where  - None)
  Derive <class 'database.models.Client'>.total_amount as Sum(Project.total_project_amount Where  - None)
  Derive <class 'database.models.Client'>.is_over_budget as Formula (-1): Rule.formula(derive=Client.is_over_budget, as_exp [...]
  Derive <class 'database.models.Client'>.invoice_total as Sum(Invoice.invoice_amount Where  - None)
  Derive <class 'database.models.Client'>.payment_total as Sum(Invoice.payment_total Where  - None)
  RowEvent Client.send_row_to_kafka() 
Mapped Class[Invoice] rules:
  Derive <class 'database.models.Invoice'>.invoice_amount as Sum(InvoiceItem.task_amount Where  - None)
  Derive <class 'database.models.Invoice'>.payment_total as Sum(Payment.amount Where  - None)
  Derive <class 'database.models.Invoice'>.invoice_balance as Formula (-1): Rule.formula(derive=Invoice.invoice_balance, as_e [...]
  Derive <class 'database.models.Invoice'>.is_paid as Formula (-1): Rule.formula(derive=Invoice.is_paid, as_expressio [...]
  Derive <class 'database.models.Invoice'>.task_count as Count(<class 'database.models.InvoiceItem'> Where  - None)
  Derive <class 'database.models.Invoice'>.completed_task_count as Count(<class 'database.models.InvoiceItem'> Where Rule.count(derive=Invoice.completed_task_count, as_count_of=InvoiceItem, where=lambda row: row.is_completed is True) - <function init_rule.<locals>.<lambda> at 0x7c9e11419c60>)
  Derive <class 'database.models.Invoice'>.is_ready as Formula (-1): Rule.formula(derive=Invoice.is_ready, as_expressi [...]
  RowEvent Invoice.send_row_to_kafka() 
Mapped Class[InvoiceItem] rules:
  Derive <class 'database.models.InvoiceItem'>.task_amount as Copy(task.total_task_amount_billed)
  Derive <class 'database.models.InvoiceItem'>.is_completed as Copy(task.is_completed)

The following attributes have been referenced

..Person.total_hours_entered: aggregate derivation
..Timesheet.hours_worked: sum derived from
..Person.total_hours_entered: - formula
..Person.billing_rate: - formula
..Person.billing_rate: constraint
..Timesheet.billing_rate: parent copy derivation
..Person.billing_rate: parent copy from
..Timesheet.billing_rate: - formula
..Timesheet.hours_worked: - formula
..Timesheet.is_billable: - formula
..Timesheet.hours_worked: constraint
..Task.total_task_hours_worked: aggregate derivation
..Timesheet.hours_worked: sum derived from
..Task.total_task_amount_billed: aggregate derivation
..Timesheet.total_amount_billed: sum derived from
..Task.total_task_hours_worked: - formula
..Task.task_budget_hours: - formula
..Project.total_project_hours: aggregate derivation
..Task.total_task_hours_worked: sum derived from
..Project.total_project_amount: aggregate derivation
..Task.total_task_amount_billed: sum derived from
..Project.total_project_amount: - formula
..Project.project_budget_amount: - formula
..Client.total_hours: aggregate derivation
..Project.total_project_hours: sum derived from
..Client.total_amount: aggregate derivation
..Project.total_project_amount: sum derived from
..Client.total_amount: - formula
..Client.budget_amount: - formula
..Client.invoice_total: aggregate derivation
..Invoice.invoice_amount: sum derived from
..Client.payment_total: aggregate derivation
..Invoice.payment_total: sum derived from
..Invoice.invoice_amount: aggregate derivation
..InvoiceItem.task_amount: sum derived from
..Invoice.payment_total: aggregate derivation
..Payment.amount: sum derived from
..Invoice.invoice_amount: - formula
..Invoice.payment_total: - formula
..Invoice.invoice_balance: - formula
..Invoice.task_count: aggregate derivation
..Invoice.completed_task_count: aggregate derivation
..InvoiceItem.is_completed: aggregate where clause
..Invoice.task_count: - formula
..Invoice.completed_task_count: - formula
..InvoiceItem.task_amount: parent copy derivation
..Task.total_task_amount_billed: parent copy from
..InvoiceItem.is_completed: parent copy derivation
..Task.is_completed: parent copy from

The following rules have been activated
Rule Bank[0x7c9e14b298e0] (loaded 2025-02-24 14:24:39.910724)
Mapped Class[Person] rules:
  Derive <class 'database.models.Person'>.total_hours_entered as Sum(Timesheet.hours_worked Where  - None)
  Derive <class 'database.models.Person'>.total_amount_billed as Formula (1): Rule.formula(derive=Person.total_amount_billed, a [...]
  Constraint Function: None 
Mapped Class[Timesheet] rules:
  Derive <class 'database.models.Timesheet'>.billing_rate as Copy(person.billing_rate)
  Derive <class 'database.models.Timesheet'>.total_amount_billed as Formula (1): Rule.formula(derive=Timesheet.total_amount_billed [...]
  Constraint Function: None 
Mapped Class[Task] rules:
  Derive <class 'database.models.Task'>.total_task_hours_worked as Sum(Timesheet.hours_worked Where  - None)
  Derive <class 'database.models.Task'>.total_task_amount_billed as Sum(Timesheet.total_amount_billed Where  - None)
  Derive <class 'database.models.Task'>.is_over_budget as Formula (1): Rule.formula(derive=Task.is_over_budget, as_expre [...]
Mapped Class[Project] rules:
  Derive <class 'database.models.Project'>.total_project_hours as Sum(Task.total_task_hours_worked Where  - None)
  Derive <class 'database.models.Project'>.total_project_amount as Sum(Task.total_task_amount_billed Where  - None)
  Derive <class 'database.models.Project'>.is_over_budget as Formula (1): Rule.formula(derive=Project.is_over_budget, as_ex [...]
Mapped Class[Client] rules:
  Derive <class 'database.models.Client'>.total_hours as Sum(Project.total_project_hours Where  - None)
  Derive <class 'database.models.Client'>.total_amount as Sum(Project.total_project_amount Where  - None)
  Derive <class 'database.models.Client'>.is_over_budget as Formula (1): Rule.formula(derive=Client.is_over_budget, as_exp [...]
  Derive <class 'database.models.Client'>.invoice_total as Sum(Invoice.invoice_amount Where  - None)
  Derive <class 'database.models.Client'>.payment_total as Sum(Invoice.payment_total Where  - None)
  RowEvent Client.send_row_to_kafka() 
Mapped Class[Invoice] rules:
  Derive <class 'database.models.Invoice'>.invoice_amount as Sum(InvoiceItem.task_amount Where  - None)
  Derive <class 'database.models.Invoice'>.payment_total as Sum(Payment.amount Where  - None)
  Derive <class 'database.models.Invoice'>.invoice_balance as Formula (1): Rule.formula(derive=Invoice.invoice_balance, as_e [...]
  Derive <class 'database.models.Invoice'>.is_paid as Formula (2): Rule.formula(derive=Invoice.is_paid, as_expressio [...]
  Derive <class 'database.models.Invoice'>.task_count as Count(<class 'database.models.InvoiceItem'> Where  - None)
  Derive <class 'database.models.Invoice'>.completed_task_count as Count(<class 'database.models.InvoiceItem'> Where Rule.count(derive=Invoice.completed_task_count, as_count_of=InvoiceItem, where=lambda row: row.is_completed is True) - <function init_rule.<locals>.<lambda> at 0x7c9e11419c60>)
  Derive <class 'database.models.Invoice'>.is_ready as Formula (3): Rule.formula(derive=Invoice.is_ready, as_expressi [...]
  RowEvent Invoice.send_row_to_kafka() 
Mapped Class[InvoiceItem] rules:
  Derive <class 'database.models.InvoiceItem'>.task_amount as Copy(task.total_task_amount_billed)
  Derive <class 'database.models.InvoiceItem'>.is_completed as Copy(task.is_completed)
Logic Bank 01.20.25 - 36 rules loaded
Exposing /Client
Exposing /Invoice
Exposing /InvoiceItem
Exposing /Payment
Exposing /Person
Exposing /Project
Exposing /Task
Exposing /Timesheet
Declare   API - api/expose_api_models, endpoint for each table on g.apifabric.ai:443, customizing...
..discovered services: ['new_service.py', 'newer_service.py', 'ontimize_api.py', 'system.py']

Authentication loaded -- api calls now require authorization header
..declare security - security/declare_security.py authentication tables loaded
Kafka Consumer not activated

API Logic Project loaded (not WSGI), version 14.03.09
.. startup message: normal start
 (running from docker container at flask_host: 0.0.0.0 - may require refresh)

API Logic Project (name: 01JMW56P6X34M85CN1WNAZCFFR) starting:
..Explore data and API at http_scheme://swagger_host:port https://g.apifabric.ai:6800   *
.... with flask_host: 0.0.0.0
.... and  swagger_port: 443

Alert: These following are **Critical** to unlocking value for project: 01JMW56P6X34M85CN1WNAZCFFR:
.. see logic.declare_logic.py       -- 
.. see security.declare_security.py -- No Grants Yet


*************************************************************************
*   Startup Instructions: Open your Browser at: https://g.apifabric.ai:6800   *
*************************************************************************

 * Debugger is active!
 * Debugger PIN: 312-062-283
